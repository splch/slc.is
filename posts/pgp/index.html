<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Generating a PGP Key | SLC is</title><meta name=description content="Sharpest corner of the IPFS."><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css></head><body><nav><ul class=menu><li><a href=/>Home</a></li><li><a href=/posts/>Posts</a></li><li><a href=/music/>Music</a></li><li><a href=/about/>About</a></li></ul><hr></nav><div class=article-meta><h1><span class=title>Generating a PGP Key</span></h1><h2 class=date>2022/03/23</h2></div><main><p><img src=/images/pgp.webp alt="Grover&amp;rsquo;s and Shor&amp;rsquo;s Algorithmic Complexities"></p><p>This is an extreme guide to generating a PGP key. A simple tutorial will suffice; however, this will help generate the most secure key possible.</p><h1 id=quantum-background>Quantum Background</h1><p>The NIST compared the <a href=https://csrc.nist.gov/CSRC/media/Presentations/NIST-Status-Update-on-Elliptic-Curves-and-Post-Qua/images-media/moody-dustin-threshold-crypto-workshop-March-2019.pdf>security of RSA and ECC keys</a> and concluded that, with sufficient lengths in key complexity, either standard will suffice.</p><p>Shor&rsquo;s algorithm factors coprime numbers, thus is able to recreate the private key to any RSA-generated public key. This NIST paper, however, asserts that Grover&rsquo;s algorithm can be used to recreate the private key to any ECC-generated public key. While true, this is the same as a brute-force solution since Grover&rsquo;s search would still need $\sqrt{N}$ qubits to find the private key. Shor&rsquo;s algorithm has a complexity of around $O(\log{(N)}^3)$ while Grover&rsquo;s has a complexity of $O(\sqrt{N})$.</p><p>Considering the difference in algorithmic complexity between Shor&rsquo;s and Grover&rsquo;s algorithms, Shor&rsquo;s poses a more significant threat to RSA encryption than Grover&rsquo;s does to Ed25519. Because of this, I recommend using Ed25519 for a PGP key pair. There are some unsupported theories that elliptic curve cryptography is not secure, but no evidence has been provided for this whatsoever.</p><h1 id=truly-random-key-seeds>Truly Random Key Seeds</h1><p>Since this post is already looking ahead many decades, the next recommendation will be seeding more entropy into the PRNG that is used to generate the PGP key pair. The elliptic curve generation will pick a random slope for a line to intersect the elliptic curve.</p><p><img src=/images/ecc.webp alt=https://www.desmos.com/calculator/hhqdcaiv7p></p><p>In theory, unless your computer is using a truly random source of entropy, the slope of the line could be rederived and the private key could be recreated. This is absurdly unlikely, but the solution is easily implemented, and the time it takes to generate the private key is negligible considering the duration you&rsquo;ll use the key.</p><p>Using a true random source of entropy could be counting the number of times a geiger counter clicks in a given time frame, or using a hardware random source of entropy like the <a href=https://onerng.info/>OneRNG V3</a>. I already have a OneRNG USB, so I&rsquo;ll seed my random numbers with that.</p><h1 id=generating-a-pgp-key-pair>Generating a PGP Key Pair</h1><p>First, install <a href=https://gnupg.org/>GnuPG</a>. This is a free software that can be used to generate PGP keys. It&rsquo;s best to use an open source and offline tool to generate keys since websites and servers could use a variety of methods to store or recreate your private key. Additionally, using a device you know is secure and private is a necessity. A simple way to handle trust is to use a live USB, then assume that there&rsquo;s no hardware-level surveillance on your device.</p><p>On the download page, it supports common operating systems like Windows, MacOS, and Linux, as well as other platforms.</p><h2 id=seed-the-prng>Seed the PRNG</h2><p>Find what entropy source GnuPG uses on your operating system. On Linux and MacOS, for example, it&rsquo;s <code>/dev/random</code>. To add entropy to the PRNG, use something like the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>rngd -r /path/to/true/randomness
</span></span></code></pre></div><h2 id=run-gnupg>Run GnuPG</h2><p>Once you have installed GnuPG, run <code>gpg --full-generate-key</code> to generate a key pair.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>~$ gpg --full-generate-key
</span></span><span style=display:flex><span>gpg <span style=color:#f92672>(</span>GnuPG<span style=color:#f92672>)</span> 2.3.4; Copyright <span style=color:#f92672>(</span>C<span style=color:#f92672>)</span> <span style=color:#ae81ff>2021</span> Free Software Foundation, Inc.
</span></span><span style=display:flex><span>This is free software: you are free to change and redistribute it.
</span></span><span style=display:flex><span>There is NO WARRANTY, to the extent permitted by law.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Please <span style=color:#66d9ef>select</span> what kind of key you want:
</span></span><span style=display:flex><span>   <span style=color:#f92672>(</span>1<span style=color:#f92672>)</span> RSA and RSA
</span></span><span style=display:flex><span>   <span style=color:#f92672>(</span>2<span style=color:#f92672>)</span> DSA and Elgamal
</span></span><span style=display:flex><span>   <span style=color:#f92672>(</span>3<span style=color:#f92672>)</span> DSA <span style=color:#f92672>(</span>sign only<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>(</span>4<span style=color:#f92672>)</span> RSA <span style=color:#f92672>(</span>sign only<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>(</span>9<span style=color:#f92672>)</span> ECC <span style=color:#f92672>(</span>sign and encrypt<span style=color:#f92672>)</span> *default*
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>10<span style=color:#f92672>)</span> ECC <span style=color:#f92672>(</span>sign only<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>14<span style=color:#f92672>)</span> Existing key from card
</span></span><span style=display:flex><span>Your selection? <span style=color:#ae81ff>9</span>
</span></span><span style=display:flex><span>Please <span style=color:#66d9ef>select</span> which elliptic curve you want:
</span></span><span style=display:flex><span>   <span style=color:#f92672>(</span>1<span style=color:#f92672>)</span> Curve <span style=color:#ae81ff>25519</span> *default*
</span></span><span style=display:flex><span>   <span style=color:#f92672>(</span>4<span style=color:#f92672>)</span> NIST P-384
</span></span><span style=display:flex><span>   <span style=color:#f92672>(</span>6<span style=color:#f92672>)</span> Brainpool P-256
</span></span><span style=display:flex><span>Your selection? <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Please specify how long the key should be valid.
</span></span><span style=display:flex><span>         0 <span style=color:#f92672>=</span> key does not expire
</span></span><span style=display:flex><span>      &lt;n&gt;  <span style=color:#f92672>=</span> key expires in n days
</span></span><span style=display:flex><span>      &lt;n&gt;w <span style=color:#f92672>=</span> key expires in n weeks
</span></span><span style=display:flex><span>      &lt;n&gt;m <span style=color:#f92672>=</span> key expires in n months
</span></span><span style=display:flex><span>      &lt;n&gt;y <span style=color:#f92672>=</span> key expires in n years
</span></span><span style=display:flex><span>Key is valid <span style=color:#66d9ef>for</span>? <span style=color:#f92672>(</span>0<span style=color:#f92672>)</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Key does not expire at all
</span></span><span style=display:flex><span>Is this correct? <span style=color:#f92672>(</span>y/N<span style=color:#f92672>)</span> y
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>GnuPG needs to construct a user ID to identify your key.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Real name: name
</span></span><span style=display:flex><span>Email address: name@example.org
</span></span><span style=display:flex><span>Comment: hello, world
</span></span><span style=display:flex><span>You selected this USER-ID:
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;name (hello, world) &lt;name@example.org&gt;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Change <span style=color:#f92672>(</span>N<span style=color:#f92672>)</span>ame, <span style=color:#f92672>(</span>C<span style=color:#f92672>)</span>omment, <span style=color:#f92672>(</span>E<span style=color:#f92672>)</span>mail or <span style=color:#f92672>(</span>O<span style=color:#f92672>)</span>kay/<span style=color:#f92672>(</span>Q<span style=color:#f92672>)</span>uit? O
</span></span><span style=display:flex><span>We need to generate a lot of random bytes. It is a good idea to perform
</span></span><span style=display:flex><span>some other action <span style=color:#f92672>(</span>type on the keyboard, move the mouse, utilize the
</span></span><span style=display:flex><span>disks<span style=color:#f92672>)</span> during the prime generation; this gives the random number
</span></span><span style=display:flex><span>generator a better chance to gain enough entropy.
</span></span><span style=display:flex><span>gpg: directory <span style=color:#e6db74>&#39;~/name/.gnupg/openpgp-revocs.d&#39;</span> created
</span></span><span style=display:flex><span>gpg: revocation certificate stored as <span style=color:#e6db74>&#39;~/name/.gnupg/openpgp-revocs.d/ABCDEFGHIJKLMNOPQRSTUVWXYANDZ01223456789.rev&#39;</span>
</span></span><span style=display:flex><span>public and secret key created and signed.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pub   ed25519 2022-03-24 <span style=color:#f92672>[</span>SC<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>      ABCDEFGHIJKLMNOPQRSTUVWXYANDZ01223456789
</span></span><span style=display:flex><span>uid                      name <span style=color:#f92672>(</span>hello, world<span style=color:#f92672>)</span> &lt;name@example.org&gt;
</span></span><span style=display:flex><span>sub   cv25519 2022-03-24 <span style=color:#f92672>[</span>E<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>It&rsquo;s reassuring to see that the recommended settings are what we decided on too! Before moving on, confirm that you now have a PGP key pair. Run <code>--list-keys</code> to view the generated key information.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>~$ gpg --list-keys
</span></span><span style=display:flex><span>gpg: checking the trustdb
</span></span><span style=display:flex><span>gpg: marginals needed: <span style=color:#ae81ff>3</span>  completes needed: <span style=color:#ae81ff>1</span>  trust model: pgp
</span></span><span style=display:flex><span>gpg: depth: <span style=color:#ae81ff>0</span>  valid:   <span style=color:#ae81ff>1</span>  signed:   <span style=color:#ae81ff>0</span>  trust: 0-, 0q, 0n, 0m, 0f, 1u
</span></span><span style=display:flex><span>~/name/.gnupg/pubring.kbx
</span></span><span style=display:flex><span>--------------------------------
</span></span><span style=display:flex><span>pub   ed25519 2022-03-24 <span style=color:#f92672>[</span>SC<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>      ABCDEFGHIJKLMNOPQRSTUVWXYANDZ01223456789
</span></span><span style=display:flex><span>uid           <span style=color:#f92672>[</span>ultimate<span style=color:#f92672>]</span> name <span style=color:#f92672>(</span>hello, world<span style=color:#f92672>)</span> &lt;name@example.org&gt;
</span></span><span style=display:flex><span>sub   cv25519 2022-03-24 <span style=color:#f92672>[</span>E<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>The <code>KEY-ID</code> is the 40 character long fingerprint for the key pair. That ID will be used to specify the key when using it.</p><h1 id=distributing-your-public-key>Distributing your <strong>public</strong> key</h1><p>You might&rsquo;ve seen people link their public key when sharing their email or other contact services. You can distribute your public key in any way you&rsquo;d like, but a good way to do this is to use a PGP key server.</p><p>There are a few key servers out there, but the most popular are:</p><ol><li>pgp.mit.edu</li><li>keyserver.ubuntu.com</li><li>keybase.io</li><li>keys.openpgp.org</li><li>keys.mailvelope.com</li></ol><blockquote><p>Key servers use pooling to distribute keys, so you can tend to upload a key once and have it distributed to many people.</p></blockquote><p>By running <code>gpg --send-keys</code> on your key pair, you can export your public key.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>gpg --send-keys ABCDEFGHIJKLMNOPQRSTUVWXYANDZ01223456789
</span></span></code></pre></div><p>This will export your public key to <a href=https://keys.openpgp.org/>keys.openpgp.org</a>. The other sites also have an upload pages, so feel free to upload there as well.</p><p>To easily copy your public key, you can use <code>gpg --export --armor</code>. The <code>--armor</code> flag will export the key in ASCII armored format.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>~$ gpg --export --armor ABCDEFGHIJKLMNOPQRSTUVWXYANDZ01223456789
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-----BEGIN PGP PUBLIC KEY BLOCK-----
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>xjMEYkAMlhYJKwYBBAHaRw8BAQdAija76hmp8YHmr0zHw+Qv1nMNsrqcsRQW
</span></span><span style=display:flex><span>cqSlqOEoHCrNHVNwZW5jZXIgQ2h1cmNoaWxsIDxtZUBzbGMuaXM+wqoEExYK
</span></span><span style=display:flex><span>ADsWIQQQICP7jXDvYysbVVUKmHynkTkZlQUCYkAMlgIbAwULCQgHAgMiAgEG
</span></span><span style=display:flex><span>FQoJCAsCAxYCAQIeBwIXgAAhCRAKmHynkTkZlRYhBBAgI/uNcO9jKxtVVQqY
</span></span><span style=display:flex><span>fKeRORmVyFAA/3tWetkYc5XKA8yDYyAeZk8cI0Cy7+1Afm/p2mQQnzXvAQCq
</span></span><span style=display:flex><span>QzdsI4owKGbHudz/DKsVKkWDCZ1yfg0FRq52qMnGAM0jU3BlbmNlciBDaHVy
</span></span><span style=display:flex><span>Y2hpbGwgPHNwZW5jZUBkdWNrLmNvbT7CqgQTFgoAOxYhBBAgI/uNcO9jKxtV
</span></span><span style=display:flex><span>VQqYfKeRORmVBQJiQBKFAhsDBQsJCAcCAyICAQYVCgkICwIDFgIBAh4HAheA
</span></span><span style=display:flex><span>ACEJEAqYfKeRORmVFiEEECAj+41w72MrG1VVCph8p5E5GZX5vwEAlCwXoyAp
</span></span><span style=display:flex><span>3bjz6x+rH1N7lqB/oIW4uPwc2bEKu43+POQA/1iqNPNTHjNsewlF19pGLljA
</span></span><span style=display:flex><span>xn946DQzWw02ulFqz5sKzjgEYkAMlhIKKwYBBAGXVQEFAQEHQNfziQppiMhw
</span></span><span style=display:flex><span>ieGfPpIMopxsvTe/scnI6G7WhoMUPbNEAwEIB8KPBBgWCgAgFiEEECAj+41w
</span></span><span style=display:flex><span>72MrG1VVCph8p5E5GZUFAmJADJYCGwwAIQkQCph8p5E5GZUWIQQQICP7jXDv
</span></span><span style=display:flex><span>YysbVVUKmHynkTkZlf+MAQCQByuimb5r1gEPoPQ0+dg0GQP16WYE/EF4WhC3
</span></span><span style=display:flex><span>kJ8QuQD+OW350m6xUU9djl7gmlnBeoNZB7EyoPuGs301bL1v6A8<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span><span style=color:#f92672>=</span>QfAK
</span></span><span style=display:flex><span>-----END PGP PUBLIC KEY BLOCK-----
</span></span></code></pre></div><h2 id=encrypting-and-decrypting-data>Encrypting and Decrypting Data</h2><p>To encrypt, run <code>--encrypt</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>gpg --encrypt --recipient ABCDEFGHIJKLMNOPQRSTUVWXYANDZ01223456789 /path/to/file
</span></span></code></pre></div><p>That will output a file named <code>/path/to/file.gpg</code>. Only you can decrypt that file with your private key. To do that use <code>--decrypt</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>gpg --decrypt --recipient ABCDEFGHIJKLMNOPQRSTUVWXYANDZ01223456789 /path/to/file.gpg &gt; /path/to/file
</span></span></code></pre></div><h1 id=backing-up-your-private-key>Backing up your private key</h1><p>To backup your private key, run <code>--export-secret-keys</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>~$ gpg --export-secret-key --armor ABCDEFGHIJKLMNOPQRSTUVWXYANDZ01223456789
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-----BEGIN PGP PRIVATE KEY BLOCK-----
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>lFgEYjw1xhYJKwYBBAHaRw8BAQdAwl9GSoOR4E7wUpe1A+Evd+ViiavBUvpvw4nf
</span></span><span style=display:flex><span>JLVtm3EAAQCTHWqtqmI1D6ODctaR3UGOLLsGZjUe1WTPP5BDQkVC9w5DtCZuYW1l
</span></span><span style=display:flex><span>ciAoaGVsbG8sIHdvcmwpIDxuYW1lQGV4YW1wbGUuY29tPoiUBBMWCgA8FiEE6Vs9
</span></span><span style=display:flex><span>vE0RXucZDtSi9KkIHalB430FAmI8NcYCGwMFCwkIBwIDIgIBBhUKCQgLAgQWAgMB
</span></span><span style=display:flex><span>Ah4HAheAAAoJEPSpCB2pQeN967EBANgog1cMEPpNYjXTZzSiOFSK4BmlwV1vghTB
</span></span><span style=display:flex><span>0xq7cLv4APsEmzZK8djumlIAD1Ur0/tgoXVk3Mt6TFibmOpMec2IA5xdBGI8NcYS
</span></span><span style=display:flex><span>CisGAQQBl1UBBQEBB0BAsR6gXGOwPgWrfmltMAh7EIZ5J8GYE206qsVhwXzhdgMB
</span></span><span style=display:flex><span>CAcAAP9G0xraBqKnhlP5pkjuaxl/qOS+5m4NtJZm4YeJ/o91qBMCiHgEGBYKACAW
</span></span><span style=display:flex><span>IQTpWz28TRFe5xkO1KL0qQgdqUHjfQUCYjw1xgIbDAAKCRD0qQgdqUHjfR1RAP9R
</span></span><span style=display:flex><span>Lm53gMSLaAAyonnsV49TSK8Lunv9ochw4LlmDc0/wQD8CUO687SXXpAVrJCvcbqu
</span></span><span style=display:flex><span>aXfYuB1XxWxcgI5phcv/VAw<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span><span style=color:#f92672>=</span>LAxH
</span></span><span style=display:flex><span>-----END PGP PRIVATE KEY BLOCK-----
</span></span></code></pre></div><p>Again, you can pipe this into a file or copy it into a notebook.</p><h1 id=conclusion>Conclusion</h1><p>PGP key generation can be as simple (from generating and managing keys from within Mailvelope) to as complex as you&rsquo;d like. The benefit with more engaged generation is you only need to do it once. After the first time, you can use the same key for any communication. I hope this tutorial is helpful in getting started with or improving your PGP keys.</p></main><footer></footer></body></html>